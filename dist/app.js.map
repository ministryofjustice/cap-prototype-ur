{
  "version": 3,
  "sources": ["../server/app.ts"],
  "sourcesContent": ["import express from 'express';\nimport createError from 'http-errors';\n\nimport errorHandler from './errorHandler';\nimport logger from './logging/logger';\nimport setupPageVisitAnalytics from './logging/setupPageVisitAnalytics';\nimport setupRequestLogging from './logging/setupRequestLogging';\nimport setupAnalytics from './middleware/setupAnalytics';\nimport setupAuthentication from './middleware/setupAuthentication';\nimport setUpCsrf from './middleware/setUpCsrf';\nimport setupFlashMessages from './middleware/setupFlashMessages';\nimport setUpHealthCheck from './middleware/setUpHealthCheck';\nimport setupHistory from './middleware/setupHistory';\nimport setUpi18n, { setUpLocaleFromSession } from './middleware/setUpi18n';\nimport setupRateLimit from './middleware/setupRateLimit';\nimport setUpWebRequestParsing from './middleware/setupRequestParsing';\nimport setupRobotsTxt from './middleware/setupRobotsTxt';\n// import setupServiceNoLongerAvailable from './middleware/setupServiceNoLongerAvailable';\nimport setUpStaticResources from './middleware/setUpStaticResources';\nimport setUpWebSecurity from './middleware/setUpWebSecurity';\nimport setUpWebSession from './middleware/setUpWebSession';\nimport routes from './routes';\nimport unauthenticatedRoutes from './routes/unauthenticatedRoutes';\nimport nunjucksSetup from './utils/nunjucksSetup';\n\nconst createApp = (): express.Application => {\n  const app = express();\n\n  app.set('json spaces', 2);\n  app.set('trust proxy', 1);\n  app.set('port', process.env.PORT || 3000);\n  // Disable X-Powered-By header for security\n  app.disable('x-powered-by');\n\n  app.use(setupRobotsTxt());\n  app.use(setUpi18n());\n  nunjucksSetup(app);\n  app.use(setUpHealthCheck());\n  app.use(setUpWebSecurity());\n  app.use(setupRateLimit());\n  app.use(setUpWebSession());\n  app.use(setUpLocaleFromSession());\n  app.use(setUpWebRequestParsing());\n  app.use(setupPageVisitAnalytics());\n  app.use(setupRequestLogging());\n  app.use(setUpStaticResources());\n  app.use(setUpCsrf());\n  app.use(setupFlashMessages());\n  app.use(setupAnalytics());\n  app.use(setupHistory());\n  // app.use(setupServiceNoLongerAvailable());\n  app.use(unauthenticatedRoutes());\n  app.use(setupAuthentication());\n  app.use(routes());\n\n  app.use((_request, _response, next) => next(createError(404)));\n  app.use(errorHandler());\n\n  return app;\n};\n\nconst app = createApp();\n\napp.listen(app.get('port'), () => {\n  logger.info(`Server listening on port ${app.get('port')}`);\n});\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;AAAA,qBAAoB;AACpB,yBAAwB;AAExB,0BAAyB;AACzB,oBAAmB;AACnB,qCAAoC;AACpC,iCAAgC;AAChC,4BAA2B;AAC3B,iCAAgC;AAChC,uBAAsB;AACtB,gCAA+B;AAC/B,8BAA6B;AAC7B,0BAAyB;AACzB,uBAAkD;AAClD,4BAA2B;AAC3B,iCAAmC;AACnC,4BAA2B;AAE3B,kCAAiC;AACjC,8BAA6B;AAC7B,6BAA4B;AAC5B,oBAAmB;AACnB,mCAAkC;AAClC,2BAA0B;AAE1B,MAAM,YAAY,MAA2B;AAC3C,QAAMA,WAAM,eAAAC,SAAQ;AAEpB,EAAAD,KAAI,IAAI,eAAe,CAAC;AACxB,EAAAA,KAAI,IAAI,eAAe,CAAC;AACxB,EAAAA,KAAI,IAAI,QAAQ,QAAQ,IAAI,QAAQ,GAAI;AAExC,EAAAA,KAAI,QAAQ,cAAc;AAE1B,EAAAA,KAAI,QAAI,sBAAAE,SAAe,CAAC;AACxB,EAAAF,KAAI,QAAI,iBAAAG,SAAU,CAAC;AACnB,2BAAAC,SAAcJ,IAAG;AACjB,EAAAA,KAAI,QAAI,wBAAAK,SAAiB,CAAC;AAC1B,EAAAL,KAAI,QAAI,wBAAAM,SAAiB,CAAC;AAC1B,EAAAN,KAAI,QAAI,sBAAAO,SAAe,CAAC;AACxB,EAAAP,KAAI,QAAI,uBAAAQ,SAAgB,CAAC;AACzB,EAAAR,KAAI,QAAI,yCAAuB,CAAC;AAChC,EAAAA,KAAI,QAAI,2BAAAS,SAAuB,CAAC;AAChC,EAAAT,KAAI,QAAI,+BAAAU,SAAwB,CAAC;AACjC,EAAAV,KAAI,QAAI,2BAAAW,SAAoB,CAAC;AAC7B,EAAAX,KAAI,QAAI,4BAAAY,SAAqB,CAAC;AAC9B,EAAAZ,KAAI,QAAI,iBAAAa,SAAU,CAAC;AACnB,EAAAb,KAAI,QAAI,0BAAAc,SAAmB,CAAC;AAC5B,EAAAd,KAAI,QAAI,sBAAAe,SAAe,CAAC;AACxB,EAAAf,KAAI,QAAI,oBAAAgB,SAAa,CAAC;AAEtB,EAAAhB,KAAI,QAAI,6BAAAiB,SAAsB,CAAC;AAC/B,EAAAjB,KAAI,QAAI,2BAAAkB,SAAoB,CAAC;AAC7B,EAAAlB,KAAI,QAAI,cAAAmB,SAAO,CAAC;AAEhB,EAAAnB,KAAI,IAAI,CAAC,UAAU,WAAW,SAAS,SAAK,mBAAAoB,SAAY,GAAG,CAAC,CAAC;AAC7D,EAAApB,KAAI,QAAI,oBAAAqB,SAAa,CAAC;AAEtB,SAAOrB;AACT;AAEA,MAAM,MAAM,UAAU;AAEtB,IAAI,OAAO,IAAI,IAAI,MAAM,GAAG,MAAM;AAChC,gBAAAsB,QAAO,KAAK,4BAA4B,IAAI,IAAI,MAAM,CAAC,EAAE;AAC3D,CAAC;",
  "names": ["app", "express", "setupRobotsTxt", "setUpi18n", "nunjucksSetup", "setUpHealthCheck", "setUpWebSecurity", "setupRateLimit", "setUpWebSession", "setUpWebRequestParsing", "setupPageVisitAnalytics", "setupRequestLogging", "setUpStaticResources", "setUpCsrf", "setupFlashMessages", "setupAnalytics", "setupHistory", "unauthenticatedRoutes", "setupAuthentication", "routes", "createError", "errorHandler", "logger"]
}
