{
  "version": 3,
  "sources": ["../../server/html/addAnswer.ts"],
  "sourcesContent": ["import { Request } from 'express';\n\nimport { PerChildFormattedAnswerForPdf } from '../utils/formattedAnswersForPdf';\n\nexport const escapeHtmlText = (text: string): string => {\n  return text\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#039;');\n};\n\n// Type guard to check if answer is a per-child answer structure\nexport const isPerChildAnswer = (answer: string | PerChildFormattedAnswerForPdf): answer is PerChildFormattedAnswerForPdf => {\n  return typeof answer === 'object' && 'defaultAnswer' in answer;\n};\n\n// Render per-child answer as HTML\nexport const renderPerChildAnswerHtml = (answer: PerChildFormattedAnswerForPdf): string => {\n  let html = '';\n  html += `  <p class=\"govuk-body govuk-!-margin-bottom-1\"><strong>For all children:</strong></p>\\n`;\n  html += `  <p class=\"answer\">${escapeHtmlText(answer.defaultAnswer)}</p>\\n`;\n\n  if (answer.perChildAnswers) {\n    for (const childAnswer of answer.perChildAnswers) {\n      html += `  <p class=\"govuk-body govuk-!-margin-bottom-1\"><strong>For ${escapeHtmlText(childAnswer.childName)}:</strong></p>\\n`;\n      html += `  <p class=\"answer\">${escapeHtmlText(childAnswer.answer)}</p>\\n`;\n    }\n  }\n\n  return html;\n};\n\nlet questionCounter = 0;\n\nexport const resetQuestionCounter = (): void => {\n  questionCounter = 0;\n};\n\nexport const getNextQuestionNumber = (): number => {\n  questionCounter++;\n  return questionCounter;\n};\n\nlet textboxCounter = 0;\n\nexport const resetTextboxCounter = (): void => {\n  textboxCounter = 0;\n};\n\nexport const renderTextBox = (heading: string, text: string): string => {\n  textboxCounter++;\n  const textareaId = `textbox-${textboxCounter}`;\n\n  return `<div class=\"text-box\">\\n  <h4>${escapeHtmlText(heading)}</h4>\\n  <div class=\"govuk-form-group\">\\n    <label class=\"govuk-label\" for=\"${textareaId}\">\\n      ${escapeHtmlText(text)}\\n    </label>\\n    <textarea class=\"govuk-textarea user-input-area\" id=\"${textareaId}\" name=\"${textareaId}\" rows=\"5\"></textarea>\\n  </div>\\n</div>\\n`;\n};\n\nconst addAnswer = (\n  sectionHeading: string | undefined,\n  question: string,\n  subtext: string | undefined,\n  answer: string | PerChildFormattedAnswerForPdf | undefined,\n  disagreeText: string,\n  request: Request,\n): string => {\n  if (!answer) return '';\n\n  questionCounter++;\n  const radioName = `question-${questionCounter}`;\n  const textareaId = `notes-${questionCounter}`;\n\n  let html = '<div class=\"answer-section\">\\n';\n\n  if (sectionHeading) {\n    html += `  <h2>${escapeHtmlText(sectionHeading)}</h2>\\n`;\n  }\n\n  html += `  <h3 class=\"question\">${escapeHtmlText(question)}</h3>\\n`;\n\n  if (subtext) {\n    html += `  <p class=\"hint\">${escapeHtmlText(subtext)}</p>\\n`;\n  }\n\n  // Handle per-child answer structure\n  if (isPerChildAnswer(answer)) {\n    html += renderPerChildAnswerHtml(answer);\n  } else {\n    html += `  <p class=\"answer\">${escapeHtmlText(answer)}</p>\\n`;\n  }\n\n  html += `  <div class=\"do-you-agree\">\\n`;\n  html += `    <div class=\"govuk-form-group\">\\n`;\n  html += `      <fieldset class=\"govuk-fieldset\">\\n`;\n  html += `        <legend class=\"govuk-fieldset__legend govuk-fieldset__legend--s\">\\n`;\n  html += `          ${escapeHtmlText(request.__('sharePlan.yourProposedPlan.doYouAgree'))}\\n`;\n  html += `        </legend>\\n`;\n  html += `        <div class=\"govuk-checkboxes govuk-checkboxes--small\" data-module=\"govuk-checkboxes\">\\n`;\n  html += `          <div class=\"govuk-checkboxes__item\">\\n`;\n  html += `            <input class=\"govuk-checkboxes__input\" id=\"${radioName}-yes\" name=\"${radioName}\" type=\"checkbox\" value=\"yes\">\\n`;\n  html += `            <label class=\"govuk-label govuk-checkboxes__label\" for=\"${radioName}-yes\">\\n`;\n  html += `              ${escapeHtmlText(request.__('yes'))}\\n`;\n  html += `            </label>\\n`;\n  html += `          </div>\\n`;\n  html += `          <div class=\"govuk-checkboxes__item\">\\n`;\n  html += `            <input class=\"govuk-checkboxes__input\" id=\"${radioName}-no\" name=\"${radioName}\" type=\"checkbox\" value=\"no\">\\n`;\n  html += `            <label class=\"govuk-label govuk-checkboxes__label\" for=\"${radioName}-no\">\\n`;\n  html += `              ${escapeHtmlText(request.__('no'))}\\n`;\n  html += `            </label>\\n`;\n  html += `          </div>\\n`;\n  html += `        </div>\\n`;\n  html += `      </fieldset>\\n`;\n  html += `    </div>\\n`;\n  html += `  </div>\\n`;\n\n  html += `  <div class=\"text-box\">\\n`;\n  html += `    <div class=\"govuk-form-group\">\\n`;\n  html += `      <label class=\"govuk-label\" for=\"${textareaId}\">\\n`;\n  html += `        ${escapeHtmlText(disagreeText)}\\n`;\n  html += `      </label>\\n`;\n  html += `      <textarea class=\"govuk-textarea user-input-area\" id=\"${textareaId}\" name=\"${textareaId}\" rows=\"5\"></textarea>\\n`;\n  html += `    </div>\\n`;\n  html += `  </div>\\n`;\n\n  html += '</div>\\n';\n\n  return html;\n};\n\nexport default addAnswer;\n"],
  "mappings": "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",
  "names": []
}
