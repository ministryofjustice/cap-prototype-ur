{
  "version": 3,
  "sources": ["../../server/test-utils/testAppSetup.ts"],
  "sourcesContent": ["import express, { Express, Router } from 'express';\nimport createError from 'http-errors';\n\nimport errorHandler from '../errorHandler';\nimport setupPageVisitAnalytics from '../logging/setupPageVisitAnalytics';\nimport setupRequestLogging from '../logging/setupRequestLogging';\nimport setupAnalytics from '../middleware/setupAnalytics';\nimport setupAuthentication from '../middleware/setupAuthentication';\nimport setUpHealthCheck from '../middleware/setUpHealthCheck';\nimport setupHistory from '../middleware/setupHistory';\nimport setUpi18n, { setUpLocaleFromSession } from '../middleware/setUpi18n';\nimport setUpWebRequestParsing from '../middleware/setupRequestParsing';\nimport setupServiceNoLongerAvailable from '../middleware/setupServiceNoLongerAvailable';\nimport routes from '../routes';\nimport unauthenticatedRoutes from '../routes/unauthenticatedRoutes';\nimport nunjucksSetup from '../utils/nunjucksSetup';\n\nimport { flashMock, sessionMock } from './testMocks';\n\nconst testAppSetup = (): Express => {\n  const app = express();\n  \n  app.disable('x-powered-by');\n  app.use(setUpi18n());\n  nunjucksSetup(app);\n  app.use((request, _response, next) => {\n    request.session = sessionMock;\n    request.flash = flashMock;\n    next();\n  });\n  app.use(setUpLocaleFromSession());\n  app.use(setUpHealthCheck());\n  app.use(setUpWebRequestParsing());\n  app.use(setupAnalytics());\n  app.use(setupHistory());\n  app.use(setupServiceNoLongerAvailable());\n  app.use(unauthenticatedRoutes());\n  app.use(setupPageVisitAnalytics());\n  app.use(setupRequestLogging());\n  app.use(setupAuthentication());\n  app.use(routes());\n\n  const testRouter = Router();\n  testRouter.get('/create-error', (_request, _response, next) => {\n    next(new Error('An error happened!'));\n  });\n  app.use(testRouter);\n\n  app.use((_request, _response, next) => next(createError(404)));\n  app.use(errorHandler());\n\n  return app;\n};\n\nexport default testAppSetup;\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAAyC;AACzC,yBAAwB;AAExB,0BAAyB;AACzB,qCAAoC;AACpC,iCAAgC;AAChC,4BAA2B;AAC3B,iCAAgC;AAChC,8BAA6B;AAC7B,0BAAyB;AACzB,uBAAkD;AAClD,iCAAmC;AACnC,2CAA0C;AAC1C,oBAAmB;AACnB,mCAAkC;AAClC,2BAA0B;AAE1B,uBAAuC;AAEvC,MAAM,eAAe,MAAe;AAClC,QAAM,UAAM,eAAAA,SAAQ;AAEpB,MAAI,QAAQ,cAAc;AAC1B,MAAI,QAAI,iBAAAC,SAAU,CAAC;AACnB,2BAAAC,SAAc,GAAG;AACjB,MAAI,IAAI,CAAC,SAAS,WAAW,SAAS;AACpC,YAAQ,UAAU;AAClB,YAAQ,QAAQ;AAChB,SAAK;AAAA,EACP,CAAC;AACD,MAAI,QAAI,yCAAuB,CAAC;AAChC,MAAI,QAAI,wBAAAC,SAAiB,CAAC;AAC1B,MAAI,QAAI,2BAAAC,SAAuB,CAAC;AAChC,MAAI,QAAI,sBAAAC,SAAe,CAAC;AACxB,MAAI,QAAI,oBAAAC,SAAa,CAAC;AACtB,MAAI,QAAI,qCAAAC,SAA8B,CAAC;AACvC,MAAI,QAAI,6BAAAC,SAAsB,CAAC;AAC/B,MAAI,QAAI,+BAAAC,SAAwB,CAAC;AACjC,MAAI,QAAI,2BAAAC,SAAoB,CAAC;AAC7B,MAAI,QAAI,2BAAAC,SAAoB,CAAC;AAC7B,MAAI,QAAI,cAAAC,SAAO,CAAC;AAEhB,QAAM,iBAAa,uBAAO;AAC1B,aAAW,IAAI,iBAAiB,CAAC,UAAU,WAAW,SAAS;AAC7D,SAAK,IAAI,MAAM,oBAAoB,CAAC;AAAA,EACtC,CAAC;AACD,MAAI,IAAI,UAAU;AAElB,MAAI,IAAI,CAAC,UAAU,WAAW,SAAS,SAAK,mBAAAC,SAAY,GAAG,CAAC,CAAC;AAC7D,MAAI,QAAI,oBAAAC,SAAa,CAAC;AAEtB,SAAO;AACT;AAEA,IAAO,uBAAQ;",
  "names": ["express", "setUpi18n", "nunjucksSetup", "setUpHealthCheck", "setUpWebRequestParsing", "setupAnalytics", "setupHistory", "setupServiceNoLongerAvailable", "unauthenticatedRoutes", "setupPageVisitAnalytics", "setupRequestLogging", "setupAuthentication", "routes", "createError", "errorHandler"]
}
