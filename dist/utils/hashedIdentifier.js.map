{
  "version": 3,
  "sources": ["../../server/utils/hashedIdentifier.ts"],
  "sourcesContent": ["import crypto from 'crypto';\n\nimport config from '../config';\nimport logger from '../logging/logger';\n\nexport const getDailySalt = (): string => {\n  const now = new Date();\n  const dateKey = `${now.getUTCFullYear()}-${now.getUTCMonth()}-${now.getUTCDate()}`;\n  return dateKey;\n};\n\nexport const generateHashedIdentifier = (\n  ip: string | undefined,\n  userAgent: string | undefined,\n  salt?: string\n): string => {\n  const actualSalt = salt || getDailySalt();\n  const data = `${ip || 'unknown'}-${userAgent || 'unknown'}-${actualSalt}`;\n\n  const secret = config.analytics.hashSecret;\n  if (!secret) {\n    logger.error('HASH_SECRET environment variable is not set');\n    return 'unknown';\n  }\n\n  return crypto\n    .createHmac('sha256', secret)\n    .update(data)\n    .digest('hex')\n    .substring(0, 16); // Truncate for brevity in logs\n};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAmB;AAEnB,oBAAmB;AACnB,oBAAmB;AAEZ,MAAM,eAAe,MAAc;AACxC,QAAM,MAAM,oBAAI,KAAK;AACrB,QAAM,UAAU,GAAG,IAAI,eAAe,CAAC,IAAI,IAAI,YAAY,CAAC,IAAI,IAAI,WAAW,CAAC;AAChF,SAAO;AACT;AAEO,MAAM,2BAA2B,CACtC,IACA,WACA,SACW;AACX,QAAM,aAAa,QAAQ,aAAa;AACxC,QAAM,OAAO,GAAG,MAAM,SAAS,IAAI,aAAa,SAAS,IAAI,UAAU;AAEvE,QAAM,SAAS,cAAAA,QAAO,UAAU;AAChC,MAAI,CAAC,QAAQ;AACX,kBAAAC,QAAO,MAAM,6CAA6C;AAC1D,WAAO;AAAA,EACT;AAEA,SAAO,cAAAC,QACJ,WAAW,UAAU,MAAM,EAC3B,OAAO,IAAI,EACX,OAAO,KAAK,EACZ,UAAU,GAAG,EAAE;AACpB;",
  "names": ["config", "logger", "crypto"]
}
