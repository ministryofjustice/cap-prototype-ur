{
  "version": 3,
  "sources": ["../../server/utils/redirectValidator.ts"],
  "sourcesContent": ["import paths from '../constants/paths';\n\n/**\n * Whitelist of allowed redirect paths for the application\n * This prevents open redirect vulnerabilities by ensuring only internal paths are used\n */\nconst ALLOWED_REDIRECT_PATHS = new Set<string>(Object.values(paths));\n\n/**\n * Validates that a redirect URL is safe and within the application's allowed paths\n * @param url - The URL to validate\n * @returns The validated URL if it's safe, or a fallback safe URL\n */\nexport const validateRedirectUrl = (url: string | undefined, fallbackUrl: string = paths.START): string => {\n  if (!url) {\n    return fallbackUrl;\n  }\n\n  // Remove any leading/trailing whitespace\n  const trimmedUrl = url.trim();\n\n  // Ensure the URL is relative (starts with /) and doesn't contain protocol or domain\n  if (!trimmedUrl.startsWith('/')) {\n    return fallbackUrl;\n  }\n\n  // Check for any attempt to use protocol-relative URLs or absolute URLs\n  if (trimmedUrl.startsWith('//') || trimmedUrl.includes('://')) {\n    return fallbackUrl;\n  }\n\n  // Remove query parameters and hash fragments for whitelist checking\n  const pathOnly = trimmedUrl.split('?')[0].split('#')[0];\n\n  // Check if the path is in the whitelist\n  if (!ALLOWED_REDIRECT_PATHS.has(pathOnly)) {\n    return fallbackUrl;\n  }\n\n  return trimmedUrl;\n};\n\n/**\n * Sanitizes a redirect URL by validating it against the whitelist\n * This is an alias for validateRedirectUrl for clarity in certain contexts\n */\nexport const sanitizeRedirectUrl = validateRedirectUrl;\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAkB;AAMlB,MAAM,yBAAyB,IAAI,IAAY,OAAO,OAAO,aAAAA,OAAK,CAAC;AAO5D,MAAM,sBAAsB,CAAC,KAAyB,cAAsB,aAAAA,QAAM,UAAkB;AACzG,MAAI,CAAC,KAAK;AACR,WAAO;AAAA,EACT;AAGA,QAAM,aAAa,IAAI,KAAK;AAG5B,MAAI,CAAC,WAAW,WAAW,GAAG,GAAG;AAC/B,WAAO;AAAA,EACT;AAGA,MAAI,WAAW,WAAW,IAAI,KAAK,WAAW,SAAS,KAAK,GAAG;AAC7D,WAAO;AAAA,EACT;AAGA,QAAM,WAAW,WAAW,MAAM,GAAG,EAAE,CAAC,EAAE,MAAM,GAAG,EAAE,CAAC;AAGtD,MAAI,CAAC,uBAAuB,IAAI,QAAQ,GAAG;AACzC,WAAO;AAAA,EACT;AAEA,SAAO;AACT;AAMO,MAAM,sBAAsB;",
  "names": ["paths"]
}
